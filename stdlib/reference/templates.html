<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>SecreC language: Templates</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SecreC language
   &#160;<span id="projectnumber">v2.00</span>
   </div>
   <div id="projectbrief">Language and standard library reference</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Templates </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Templates in SecreC</p>
<h1><a class="anchor" id="templates"></a>
Templates</h1>
<p>In order to support domain type polymorphic procedures the language has support for C++’like function templates. Function templates give the language static domain, type and dimension polymorphism. Templates are declared using the <b>template</b> keyword, and the template domain, type and dimension parameters are listed between &lt; and &gt; parenthesis.</p>
<p>Listing 1: Simple template declaration </p><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;domain D, type T, dim N&gt;</div>
<div class="line"><a class="code" href="group__shared3p__statistics__regression.html#gabfbdb14b3e3206ff105810e0403a0f1a">D</a> T <a class="code" href="group__minimum.html#ga3ddb8714cfea986b50fc9d6ef7e466f8">minimum</a> (<a class="code" href="group__shared3p__statistics__regression.html#gabfbdb14b3e3206ff105810e0403a0f1a">D</a> T[[N]] arr) { ... }</div>
</div><!-- fragment --><p>Templates may restrict a domain variable to a protection kind.</p>
<p>Listing 2: Simple template declaration </p><div class="fragment"><div class="line">kind <a class="code" href="group__shared3p__statistics__regression.html#ga2850770338c5b568e8b6434bb5d202a2">shared3p</a> ;</div>
<div class="line"><span class="keyword">template</span> &lt;domain D : shared3p,  type T&gt;</div>
<div class="line">T declassify (<a class="code" href="group__shared3p__statistics__regression.html#gabfbdb14b3e3206ff105810e0403a0f1a">D</a> T x) { ... }</div>
</div><!-- fragment --><p>Code generation of concrete template instances (or instantiation for short) is performed on demand after code for regular functions has been generated. If at any point a template function is called, the instantiation to given call parameters is added into instantiation queue if the template has yet to be instantiated with those parameters. The process continues as long as the queue is not empty. Note that the instantiation process eventually terminates, as there’s finite number of templates, and finite number of declared domain types. The template body is type checked when it’s required to be instantiated to concrete domain types. We do not perform two phase name lookup as C++, and uninstantiated templates may even refer to undeclared global symbols. If multiple function or template matches are found for a single call site a following priority system is used to select a single match. First the number of template variables are compared, next the number template variables that are not restricted with domain kind are compared, and finally the number of quantified function domain type parameters are compared. A unique minimum is used to perform the call. If unique minimum is not found a type error is raised. The intuitive idea behind the resolution system is that the most specialized template or procedure is selected. For example, reclassification can be defined between two potentially different domains, but also within a single domain. If so, then the version that uses a single template variable is selected whenever possible.</p>
<p>Listing 3: Reclassify </p><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;domain D : shared3p , domain L : shared3p &gt;</div>
<div class="line"><a class="code" href="group__shared3p__statistics__regression.html#gabfbdb14b3e3206ff105810e0403a0f1a">D</a> <span class="keywordtype">int</span> reclassify (L <span class="keywordtype">int</span> x) { ... }</div>
<div class="line"><span class="keyword">template</span> &lt;domain D&gt;</div>
<div class="line"><a class="code" href="group__shared3p__statistics__regression.html#gabfbdb14b3e3206ff105810e0403a0f1a">D</a> <span class="keywordtype">int</span> reclassify (<a class="code" href="group__shared3p__statistics__regression.html#gabfbdb14b3e3206ff105810e0403a0f1a">D</a> <span class="keywordtype">int</span> x) { <span class="keywordflow">return</span> x; }</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Dec 18 2016 14:24:19 for SecreC language by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
